{
  "id": "b8b4e924-26d6-429e-bfb8-f5fc286e4f9f",
  "revision": 0,
  "last_node_id": 578,
  "last_link_id": 990,
  "nodes": [
    {
      "id": 115,
      "type": "SetNode",
      "pos": [
        670,
        1580
      ],
      "size": [
        210,
        60
      ],
      "flags": {
        "pinned": true
      },
      "order": 44,
      "mode": 0,
      "inputs": [
        {
          "name": "MODEL",
          "type": "MODEL",
          "link": 624
        }
      ],
      "outputs": [
        {
          "name": "*",
          "type": "*",
          "links": null
        }
      ],
      "title": "Set_MODEL",
      "properties": {
        "previousName": "MODEL",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        "MODEL"
      ],
      "color": "#223",
      "bgcolor": "#335"
    },
    {
      "id": 37,
      "type": "Note",
      "pos": [
        10,
        1580
      ],
      "size": [
        280,
        130
      ],
      "flags": {
        "pinned": true
      },
      "order": 0,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "properties": {
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        "IF you have 32gb but only 12/16gb or even less vram, you might want to use the \"Low Vram high ram\" loader to offload parts of the model to prevent out of memory errors. You can use this on any card, it can be useful even on a 4090, though be careful with only 16gb ram, you might need to change the virtual vram gb to less."
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 114,
      "type": "SetNode",
      "pos": [
        670,
        1690
      ],
      "size": [
        210,
        60
      ],
      "flags": {
        "pinned": true
      },
      "order": 45,
      "mode": 0,
      "inputs": [
        {
          "name": "CLIP",
          "type": "CLIP",
          "link": 119
        }
      ],
      "outputs": [
        {
          "name": "*",
          "type": "*",
          "links": null
        }
      ],
      "title": "Set_CLIP",
      "properties": {
        "previousName": "CLIP",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        "CLIP"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 113,
      "type": "SetNode",
      "pos": [
        670,
        1800
      ],
      "size": [
        210,
        60
      ],
      "flags": {
        "pinned": true
      },
      "order": 25,
      "mode": 0,
      "inputs": [
        {
          "name": "VAE",
          "type": "VAE",
          "link": 118
        }
      ],
      "outputs": [
        {
          "name": "*",
          "type": "*",
          "links": null
        }
      ],
      "title": "Set_VAE",
      "properties": {
        "previousName": "VAE",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        "VAE"
      ],
      "color": "#322",
      "bgcolor": "#533"
    },
    {
      "id": 394,
      "type": "Fast Groups Bypasser (rgthree)",
      "pos": [
        910,
        1340
      ],
      "size": [
        380,
        154
      ],
      "flags": {
        "pinned": true
      },
      "order": 1,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "OPT_CONNECTION",
          "type": "*",
          "links": null
        }
      ],
      "properties": {
        "matchColors": "blue",
        "matchTitle": "",
        "showNav": true,
        "showAllGraphs": true,
        "sort": "position",
        "customSortAlphabet": "",
        "toggleRestriction": "always one",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "color": "#223",
      "bgcolor": "#335"
    },
    {
      "id": 51,
      "type": "ClipLoaderGGUF",
      "pos": [
        -380,
        2190
      ],
      "size": [
        370,
        110
      ],
      "flags": {
        "pinned": true
      },
      "order": 2,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "CLIP",
          "type": "CLIP",
          "links": [
            56
          ]
        }
      ],
      "properties": {
        "cnr_id": "gguf",
        "ver": "556ffba1a1dff3f5e1d1ad65c3103839883a824c",
        "Node name for S&R": "ClipLoaderGGUF",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        "umt5-xxl-encoder-Q8_0.gguf",
        "wan",
        "default"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 41,
      "type": "VAELoader",
      "pos": [
        -380,
        2350
      ],
      "size": [
        370,
        60
      ],
      "flags": {
        "pinned": true
      },
      "order": 3,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "VAE",
          "type": "VAE",
          "slot_index": 0,
          "links": [
            118
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.34",
        "Node name for S&R": "VAELoader",
        "models": [
          {
            "name": "wan_2.1_vae.safetensors",
            "url": "https://huggingface.co/Comfy-Org/Wan_2.1_ComfyUI_repackaged/resolve/main/split_files/vae/wan_2.1_vae.safetensors",
            "hash": "2fc39d31359a4b0a64f55876d8ff7fa8d780956ae2cb13463b0223e15148976b",
            "hash_type": "SHA256",
            "directory": "vae"
          }
        ],
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        "wan_2.1_vae.safetensors"
      ],
      "color": "#322",
      "bgcolor": "#533"
    },
    {
      "id": 429,
      "type": "ModelPatchTorchSettings",
      "pos": [
        320,
        2090
      ],
      "size": [
        280,
        60
      ],
      "flags": {
        "pinned": true
      },
      "order": 35,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "MODEL",
          "link": 704
        }
      ],
      "outputs": [
        {
          "name": "MODEL",
          "type": "MODEL",
          "links": [
            705
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfyui-kjnodes",
        "ver": "5dcda71011870278c35d92ff77a677ed2e538f2d",
        "Node name for S&R": "ModelPatchTorchSettings",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        true
      ],
      "color": "#222",
      "bgcolor": "#000"
    },
    {
      "id": 50,
      "type": "Note",
      "pos": [
        310,
        1580
      ],
      "size": [
        300,
        90
      ],
      "flags": {
        "pinned": true
      },
      "order": 4,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "properties": {
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        "Feel free to enabled those Optimizations if you have updated torch, and for the one on the top sage attention installed."
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 397,
      "type": "TorchCompileModelWanVideoV2",
      "pos": [
        320,
        2250
      ],
      "size": [
        282.74609375,
        202
      ],
      "flags": {
        "pinned": true
      },
      "order": 39,
      "mode": 4,
      "inputs": [
        {
          "name": "model",
          "type": "MODEL",
          "link": 705
        }
      ],
      "outputs": [
        {
          "name": "MODEL",
          "type": "MODEL",
          "links": [
            623
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfyui-kjnodes",
        "ver": "1.1.1",
        "Node name for S&R": "TorchCompileModelWanVideoV2",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        "inductor",
        false,
        "default",
        false,
        true,
        64,
        true
      ],
      "color": "#222",
      "bgcolor": "#000"
    },
    {
      "id": 54,
      "type": "Power Lora Loader (rgthree)",
      "pos": [
        -380,
        2460
      ],
      "size": [
        590,
        286
      ],
      "flags": {
        "pinned": true
      },
      "order": 42,
      "mode": 0,
      "inputs": [
        {
          "dir": 3,
          "name": "model",
          "type": "MODEL",
          "link": 623
        },
        {
          "dir": 3,
          "name": "clip",
          "type": "CLIP",
          "link": 56
        }
      ],
      "outputs": [
        {
          "dir": 4,
          "name": "MODEL",
          "shape": 3,
          "type": "MODEL",
          "links": [
            624
          ]
        },
        {
          "dir": 4,
          "name": "CLIP",
          "shape": 3,
          "type": "CLIP",
          "links": [
            119
          ]
        }
      ],
      "properties": {
        "cnr_id": "rgthree-comfy",
        "ver": "6c5f7c95ed8487fe08e42bd0341cae6dc9c0f0ad",
        "Show Strengths": "Single Strength",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        {},
        {
          "type": "PowerLoraLoaderHeaderWidget"
        },
        {
          "on": false,
          "lora": "wan\\Wan21_T2V_14B_lightx2v_cfg_step_distill_lora_rank32.safetensors",
          "strength": 1,
          "strengthTwo": null
        },
        {
          "on": false,
          "lora": "wan\\Wan21_T2V_14B_MoviiGen_lora_rank32_fp16.safetensors",
          "strength": 1,
          "strengthTwo": null
        },
        {
          "on": false,
          "lora": "wan\\FusionX_FaceNaturalizer.safetensors",
          "strength": 0.7,
          "strengthTwo": null
        },
        {
          "on": false,
          "lora": "wan\\È´òÈÄüÂä®ÊÄÅ.safetensors",
          "strength": 0.5,
          "strengthTwo": null
        },
        {
          "on": false,
          "lora": "wan\\DetailEnhancerV1.safetensors",
          "strength": 0.2,
          "strengthTwo": null
        },
        {
          "on": false,
          "lora": "wan\\Wan2.1-Fun-14B-InP-HPS2.1.safetensors",
          "strength": 0.2,
          "strengthTwo": null
        },
        {
          "on": false,
          "lora": "wan\\Wan2.1-Fun-14B-InP-MPS.safetensors",
          "strength": 0.2,
          "strengthTwo": null
        },
        {},
        ""
      ],
      "color": "#323",
      "bgcolor": "#535"
    },
    {
      "id": 427,
      "type": "UNETLoader",
      "pos": [
        -370,
        1620
      ],
      "size": [
        350,
        90
      ],
      "flags": {
        "pinned": true
      },
      "order": 5,
      "mode": 4,
      "inputs": [],
      "outputs": [
        {
          "name": "MODEL",
          "type": "MODEL",
          "links": [
            706
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.40",
        "Node name for S&R": "UNETLoader",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        "wan\\Wan2.1-T2V-1.3B-FP16.safetensors",
        "default"
      ]
    },
    {
      "id": 40,
      "type": "Fast Groups Bypasser (rgthree)",
      "pos": [
        10,
        1810
      ],
      "size": [
        280,
        106
      ],
      "flags": {
        "pinned": true
      },
      "order": 6,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "OPT_CONNECTION",
          "type": "*",
          "links": null
        }
      ],
      "properties": {
        "matchColors": "purple",
        "matchTitle": "",
        "showNav": true,
        "showAllGraphs": true,
        "sort": "position",
        "customSortAlphabet": "",
        "toggleRestriction": "max one",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "color": "#323",
      "bgcolor": "#535"
    },
    {
      "id": 47,
      "type": "UnetLoaderGGUFDisTorchMultiGPU",
      "pos": [
        -370,
        1970
      ],
      "size": [
        350,
        160
      ],
      "flags": {
        "pinned": true
      },
      "order": 7,
      "mode": 4,
      "inputs": [],
      "outputs": [
        {
          "name": "MODEL",
          "type": "MODEL",
          "links": [
            708
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfyui-multigpu",
        "ver": "a05823ff0a5296332ae478b18ab93b46cd996a44",
        "Node name for S&R": "UnetLoaderGGUFDisTorchMultiGPU",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        "wan\\SkyReels-V2-T2V-14B-720P-VACE-Q5_K_S.gguf",
        "cuda:0",
        24,
        false,
        ""
      ]
    },
    {
      "id": 48,
      "type": "Any Switch (rgthree)",
      "pos": [
        10,
        1760
      ],
      "size": [
        250.08045959472656,
        106
      ],
      "flags": {
        "collapsed": true,
        "pinned": true
      },
      "order": 29,
      "mode": 0,
      "inputs": [
        {
          "dir": 3,
          "name": "any_01",
          "type": "MODEL",
          "link": 706
        },
        {
          "dir": 3,
          "name": "any_02",
          "type": "MODEL",
          "link": 707
        },
        {
          "dir": 3,
          "name": "any_03",
          "type": "MODEL",
          "link": 708
        },
        {
          "dir": 3,
          "name": "any_04",
          "type": "MODEL",
          "link": null
        },
        {
          "dir": 3,
          "name": "any_05",
          "type": "MODEL",
          "link": null
        }
      ],
      "outputs": [
        {
          "dir": 4,
          "label": "MODEL",
          "name": "*",
          "shape": 3,
          "type": "MODEL",
          "links": [
            622
          ]
        }
      ],
      "title": "Model switch",
      "properties": {
        "cnr_id": "rgthree-comfy",
        "ver": "aa6c75a30b3ee8f01d7c9f8b0a126cccdc90616a",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": []
    },
    {
      "id": 430,
      "type": "Fast Groups Bypasser (rgthree)",
      "pos": [
        310,
        1720
      ],
      "size": [
        300,
        110
      ],
      "flags": {
        "pinned": true
      },
      "order": 8,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "OPT_CONNECTION",
          "type": "*",
          "links": null
        }
      ],
      "title": "Optimizations",
      "properties": {
        "matchColors": "black",
        "matchTitle": "",
        "showNav": true,
        "showAllGraphs": true,
        "sort": "position",
        "customSortAlphabet": "",
        "toggleRestriction": "default",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "color": "#222",
      "bgcolor": "#000"
    },
    {
      "id": 488,
      "type": "GetNode",
      "pos": [
        1324.7596050846416,
        1569.7577884272848
      ],
      "size": [
        210,
        58
      ],
      "flags": {},
      "order": 9,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "MODEL",
          "type": "MODEL",
          "links": [
            925
          ]
        }
      ],
      "title": "Get_MODEL",
      "properties": {
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        "MODEL"
      ],
      "color": "#223",
      "bgcolor": "#335"
    },
    {
      "id": 489,
      "type": "GetNode",
      "pos": [
        1324.7596050846416,
        1679.7577884272848
      ],
      "size": [
        210,
        58
      ],
      "flags": {},
      "order": 10,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "CLIP",
          "type": "CLIP",
          "links": [
            780,
            782,
            862
          ]
        }
      ],
      "title": "Get_CLIP",
      "properties": {
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        "CLIP"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 490,
      "type": "GetNode",
      "pos": [
        1324.7596050846416,
        1789.7577884272853
      ],
      "size": [
        210,
        58
      ],
      "flags": {},
      "order": 11,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "VAE",
          "type": "VAE",
          "links": [
            788,
            795
          ]
        }
      ],
      "title": "Get_VAE",
      "properties": {
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        "VAE"
      ],
      "color": "#322",
      "bgcolor": "#533"
    },
    {
      "id": 492,
      "type": "Note",
      "pos": [
        2214.759605084642,
        1629.7577884272848
      ],
      "size": [
        380,
        110
      ],
      "flags": {},
      "order": 12,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "properties": {
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        "Since umt5 is a variant based on T5, the input of prompt supports multiple languages.\n\n---\n\nÁî±‰∫é umt5 ÊòØÂü∫‰∫é T5 ÁöÑÂèò‰ΩìÔºåÊâÄ‰ª•ÊèêÁ§∫ËØçËæìÂÖ•ÊòØÊîØÊåÅÂ§öÁßçËØ≠Ë®ÄËæìÂÖ•ÁöÑ"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 493,
      "type": "Note",
      "pos": [
        2614.759605084642,
        1629.7577884272848
      ],
      "size": [
        280,
        110
      ],
      "flags": {},
      "order": 13,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "properties": {
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        "Test around with the shift value to get your prefered results, you can also disable it."
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 505,
      "type": "Note",
      "pos": [
        1324.7596050846416,
        1899.7577884272853
      ],
      "size": [
        270,
        180
      ],
      "flags": {},
      "order": 14,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "properties": {
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        "Use the lossless animated .webp for video extension instead of .mp4 or .webm to avoid color shifting or compression artifact issues. The lossless image/webp format yields the best results. \n\nIf you run into a \"Request Entity Too Large\" error when uploading, just place the WebP file directly into the ComfyUI\\input folder, hit reload (R), and select it using the Load Image node instead of using the \"choose file to upload\" option."
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 506,
      "type": "MarkdownNote",
      "pos": [
        2914.759605084642,
        1629.7577884272848
      ],
      "size": [
        580,
        170
      ],
      "flags": {},
      "order": 15,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "properties": {
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        "### Based on ‚Äúcausvid wan img2vid ‚Äì improved motion with two samplers in series‚Äù by [u/Maraan666](https://www.reddit.com/r/StableDiffusion/comments/1ksxy6m/causvid_wan_img2vid_improved_motion_with_two/)\n\n- **Workflow Included**: [Pastebin Link](https://pastebin.com/3BxTp9Ma)\n- **Summary**:  \n  This approach addresses the issue of CausVid LoRA reducing motion quality by using two samplers in sequence:\n  - First few steps: without the CausVid LoRA  \n  - Remaining steps: with the CausVid LoRA  \n"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 55,
      "type": "MarkdownNote",
      "pos": [
        210,
        1040
      ],
      "size": [
        680,
        450
      ],
      "flags": {
        "pinned": true
      },
      "order": 16,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "properties": {
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        "# Wan2.1 Video Generation (VACE)\n\n[**Tutorial**](https://docs.comfy.org/tutorials/video/wan/vace) | [**ÊïôÁ®ã (‰∏≠Êñá)**](https://docs.comfy.org/zh-CN/tutorials/video/wan/vace)\n\n---\n\n## üß† Diffusion Models\n\n- [SkyReels-V2-T2V-14B-720P-VACE-GGUF](https://huggingface.co/QuantStack/SkyReels-V2-T2V-14B-720P-VACE-GGUF) (finetuned in 720p@24fps)\n- [Wan-14B-T2V-FusionX-VACE-GGUF](https://huggingface.co/QuantStack/Wan-14B-T2V-FusionX-VACE-GGUF) (high-quality merge by [vrgamedevgirl](https://civitai.com/models/1651125))\n- [MoviiGen1.1-VACE-GGUF](https://huggingface.co/QuantStack/MoviiGen1.1-VACE-GGUF) (finetuned on cinematic shots in 720p and up)\n- [Wan2.1-VACE-14B-GGUF](https://huggingface.co/QuantStack/Wan2.1-VACE-14B-GGUF) (base model 480p@16fps)\n\n---\n\n## üé® VAE\n\n- [wan_2.1_vae.safetensors](https://huggingface.co/Comfy-Org/Wan_2.1_ComfyUI_repackaged/resolve/main/split_files/vae/wan_2.1_vae.safetensors?download=true)\n\n---\n\n## üìù Text Encoders  \nChoose **one** of the following:\n\n- [umt5_xxl_fp16.safetensors](https://huggingface.co/Comfy-Org/Wan_2.1_ComfyUI_repackaged/resolve/main/split_files/text_encoders/umt5_xxl_fp16.safetensors?download=true)  \n- [umt5_xxl_fp8_e4m3fn_scaled.safetensors](https://huggingface.co/Comfy-Org/Wan_2.1_ComfyUI_repackaged/resolve/main/split_files/text_encoders/umt5_xxl_fp8_e4m3fn_scaled.safetensors?download=true)  \n- [umt5-xxl-encoder-gguf](https://huggingface.co/city96/umt5-xxl-encoder-gguf/tree/main)  \n\n> You can choose between .fp16, .fp8, or GGUF versions.\n\n---\n\n## üîß Optional LoRA Models\n\nThese LoRA adapters can optionally be applied to enhance or accelerate generation. Choose based on your use case:\n\n### üöÄ Speed Optimization\n\n#### üîÅ CausVid LoRAs\n\nCausVid LoRAs are experimental derivatives of the CausVid fine-tunes. The goal is to benefit from the temporal distillation in CausVid, rather than perform true causal inference.\n\n- **v1** ‚Äì A direct extraction from the CausVid fine-tune. May degrade motion quality and introduce flashing artifacts at full strength.  \n  üîó [Download v1](https://huggingface.co/Kijai/WanVideo_comfy/blob/main/Wan21_CausVid_14B_T2V_lora_rank32.safetensors)\n\n- **v1.5** ‚Äì Identical to v1 but with the first block removed, resolving the flashing issue while preserving similar motion characteristics.  \n  üîó [Download v1.5](https://huggingface.co/Kijai/WanVideo_comfy/blob/main/Wan21_CausVid_14B_T2V_lora_rank32_v1_5_no_first_block.safetensors)\n\n- **v2** ‚Äì A further pruned version that retains only the attention layers (first block removed). Fixes flashing, improves motion preservation, and benefits from more inference steps and higher CFG (classifier-free guidance).  \n  üîó [Download v2](https://huggingface.co/Kijai/WanVideo_comfy/blob/main/Wan21_CausVid_14B_T2V_lora_rank32_v2.safetensors)  \n\nüß† Based on the [**CausVid framework**](https://aejion.github.io/accvideo/), converting a bidirectional transformer into an autoregressive one with streaming support.\n\n#### üèéÔ∏è AccVid LoRA\n\n- [**Wan21_AccVid_T2V_14B_lora_rank32_fp16.safetensors**](https://huggingface.co/Kijai/WanVideo_comfy/blob/main/Wan21_AccVid_T2V_14B_lora_rank32_fp16.safetensors)  \n  Built on the [**AccVideo framework**](https://aejion.github.io/accvideo/), using trajectory-based few-step distillation from synthetic data for faster, more efficient inference.\n\n### üé¨ Cinematic Quality\n\n- [Wan21_T2V_14B_MoviiGen_lora_rank32_fp16.safetensors](https://huggingface.co/Kijai/WanVideo_comfy/blob/main/Wan21_T2V_14B_MoviiGen_lora_rank32_fp16.safetensors)  \n  Fine-tuned from [**MoviiGen 1.1**](https://huggingface.co/ZuluVision/MoviiGen1.1), optimized for **cinematic visual quality**. \n\n### üèÜ Preference-Driven Rewards\n\n- [Wan2.1-Fun-14B-InP-MPS.safetensors](https://huggingface.co/alibaba-pai/Wan2.1-Fun-Reward-LoRAs/blob/main/Wan2.1-Fun-14B-InP-MPS.safetensors)  \n  Powered by [**MPS**](https://github.com/Kwai-Kolors/MPS), a CLIP-based scoring model trained on 918K human preference choices across four dimensions: aesthetics, semantic alignment, detail quality, and overall quality.\n\n- [Wan2.1-Fun-14B-InP-HPS2.1.safetensors](https://huggingface.co/alibaba-pai/Wan2.1-Fun-Reward-LoRAs/blob/main/Wan2.1-Fun-14B-InP-HPS2.1.safetensors)  \n  Built on [**HPS v2**](https://github.com/tgxs002/HPSv2), fine-tuned on 798K human-labeled image pairs. Provides more accurate and generalizable human preference feedback for text-to-video models.\n\n---\n\n## üìÅ File Save Structure\n\nSave all required files into the following directory structure under your ComfyUI/ folder:\n\nFile save location\n\n```\nComfyUI/\n‚îú‚îÄ‚îÄ models/\n‚îÇ   ‚îú‚îÄ‚îÄ loras/\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ Wan21_CausVid_14B_T2V_lora_rank32.safetensors\n‚îÇ   ‚îú‚îÄ‚îÄ unet/\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ MoviiGen1.1-VACE-Qx_x_x.gguf\n‚îÇ   ‚îú‚îÄ‚îÄ text_encoders/\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ umt5_xxl_fp8_e4m3fn_scaled.safetensors # or GGUF (umt5-xxl-encoder-Qx_x.gguf)\n‚îÇ   ‚îî‚îÄ‚îÄ vae/\n‚îÇ       ‚îî‚îÄ‚îÄ  wan_2.1_vae.safetensors\n\n```\n"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 49,
      "type": "PathchSageAttentionKJ",
      "pos": [
        293.07318352229555,
        1922.6927736828438
      ],
      "size": [
        344.49756010146734,
        58
      ],
      "flags": {},
      "order": 32,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "MODEL",
          "link": 622
        }
      ],
      "outputs": [
        {
          "name": "MODEL",
          "type": "MODEL",
          "links": [
            704
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfyui-kjnodes",
        "ver": "5dcda71011870278c35d92ff77a677ed2e538f2d",
        "Node name for S&R": "PathchSageAttentionKJ",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        "sageattn_qk_int8_pv_fp8_cuda"
      ],
      "color": "#222",
      "bgcolor": "#000"
    },
    {
      "id": 491,
      "type": "CLIPTextEncode",
      "pos": [
        2065.427892140365,
        2003.1244689008277
      ],
      "size": [
        380,
        150
      ],
      "flags": {},
      "order": 26,
      "mode": 0,
      "inputs": [
        {
          "name": "clip",
          "type": "CLIP",
          "link": 780
        }
      ],
      "outputs": [
        {
          "name": "CONDITIONING",
          "type": "CONDITIONING",
          "slot_index": 0,
          "links": [
            787,
            921
          ]
        }
      ],
      "title": "CLIP Text Encode (Negative Prompt)",
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.34",
        "Node name for S&R": "CLIPTextEncode",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        "Overexposure, blurred, deformed limbs, inaccurate anatomy, poorly drawn, paintings, subtitles, cluttered background, watermarks, text, logo."
      ],
      "color": "#322",
      "bgcolor": "#533"
    },
    {
      "id": 497,
      "type": "ModelSamplingSD3",
      "pos": [
        2793.957721867116,
        1896.081898219362
      ],
      "size": [
        280,
        58
      ],
      "flags": {},
      "order": 34,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "MODEL",
          "link": 926
        }
      ],
      "outputs": [
        {
          "name": "MODEL",
          "type": "MODEL",
          "slot_index": 0,
          "links": [
            822,
            924
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.34",
        "Node name for S&R": "ModelSamplingSD3",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        8.000000000000002
      ],
      "color": "#232",
      "bgcolor": "#353"
    },
    {
      "id": 500,
      "type": "TrimVideoLatent",
      "pos": [
        5909.121493923264,
        2475.8481457944195
      ],
      "size": [
        250,
        60
      ],
      "flags": {
        "collapsed": false
      },
      "order": 47,
      "mode": 0,
      "inputs": [
        {
          "name": "samples",
          "type": "LATENT",
          "link": 784
        },
        {
          "name": "trim_amount",
          "type": "INT",
          "widget": {
            "name": "trim_amount"
          },
          "link": 785
        }
      ],
      "outputs": [
        {
          "name": "LATENT",
          "type": "LATENT",
          "links": [
            794
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.34",
        "Node name for S&R": "TrimVideoLatent",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {
            "trim_amount": true
          },
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        0
      ]
    },
    {
      "id": 571,
      "type": "ImageCrop+",
      "pos": [
        1851.1908920498201,
        3716.927148911524
      ],
      "size": [
        315,
        194
      ],
      "flags": {},
      "order": 30,
      "mode": 0,
      "inputs": [
        {
          "name": "image",
          "type": "IMAGE",
          "link": 938
        }
      ],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "slot_index": 0,
          "links": [
            939
          ]
        },
        {
          "name": "x",
          "type": "INT",
          "links": null
        },
        {
          "name": "y",
          "type": "INT",
          "links": null
        }
      ],
      "properties": {
        "cnr_id": "comfyui_essentials",
        "ver": "1.1.0",
        "Node name for S&R": "ImageCrop+",
        "ue_properties": {
          "widget_ue_connectable": {},
          "version": "7.5.1",
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        1920,
        1080,
        "top-left",
        0,
        1080
      ]
    },
    {
      "id": 573,
      "type": "VHS_VideoCombine",
      "pos": [
        2195.9511531618223,
        3975.03308477148
      ],
      "size": [
        385.59430358287796,
        555.1701053636309
      ],
      "flags": {},
      "order": 36,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 940
        },
        {
          "name": "audio",
          "shape": 7,
          "type": "AUDIO",
          "link": null
        },
        {
          "name": "meta_batch",
          "shape": 7,
          "type": "VHS_BatchManager",
          "link": null
        },
        {
          "name": "vae",
          "shape": 7,
          "type": "VAE",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "Filenames",
          "type": "VHS_FILENAMES",
          "links": null
        }
      ],
      "properties": {
        "cnr_id": "comfyui-videohelpersuite",
        "ver": "1.7.7",
        "Node name for S&R": "VHS_VideoCombine",
        "ue_properties": {
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {},
          "version": "7.5.1"
        }
      },
      "widgets_values": {
        "frame_rate": 16,
        "loop_count": 0,
        "filename_prefix": "AnimateDiff",
        "format": "video/h264-mp4",
        "pix_fmt": "yuv420p",
        "crf": 19,
        "save_metadata": true,
        "trim_to_audio": false,
        "pingpong": false,
        "save_output": false,
        "videopreview": {
          "hidden": false,
          "paused": false,
          "params": {
            "filename": "AnimateDiff_00013.mp4",
            "subfolder": "",
            "type": "temp",
            "format": "video/h264-mp4",
            "frame_rate": 16,
            "workflow": "AnimateDiff_00013.png",
            "fullpath": "/code/ComfyUI/temp/AnimateDiff_00013.mp4"
          }
        }
      }
    },
    {
      "id": 575,
      "type": "PreviewImage",
      "pos": [
        2957.4587550272367,
        3808.743936199942
      ],
      "size": [
        547.7620485882849,
        320.2205125590733
      ],
      "flags": {},
      "order": 40,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 942
        }
      ],
      "outputs": [],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.68",
        "Node name for S&R": "PreviewImage",
        "ue_properties": {
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {},
          "version": "7.5.1"
        }
      },
      "widgets_values": []
    },
    {
      "id": 552,
      "type": "VHS_LoadImagesPath",
      "pos": [
        1886.8631267136032,
        2996.437337224698
      ],
      "size": [
        480,
        170
      ],
      "flags": {},
      "order": 17,
      "mode": 0,
      "inputs": [
        {
          "name": "meta_batch",
          "shape": 7,
          "type": "VHS_BatchManager",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "links": [
            881
          ]
        },
        {
          "name": "MASK",
          "type": "MASK",
          "links": null
        },
        {
          "name": "frame_count",
          "type": "INT",
          "links": null
        }
      ],
      "properties": {
        "cnr_id": "comfyui-videohelpersuite",
        "ver": "1.6.1",
        "Node name for S&R": "VHS_LoadImagesPath",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": {
        "directory": "ComfyUI/output/png_seq/ctrl_mask/",
        "image_load_cap": 0,
        "skip_first_images": 0,
        "select_every_nth": 1,
        "videopreview": {
          "hidden": false,
          "paused": false,
          "params": {
            "image_load_cap": 0,
            "skip_first_images": 0,
            "select_every_nth": 1,
            "filename": "ComfyUI/output/png_seq/ctrl_mask/",
            "type": "path",
            "format": "folder"
          }
        }
      },
      "color": "#232",
      "bgcolor": "#353"
    },
    {
      "id": 574,
      "type": "GetImageRangeFromBatch",
      "pos": [
        2859.3545939381015,
        3433.8126635556077
      ],
      "size": [
        280.3267578125,
        110
      ],
      "flags": {},
      "order": 37,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "shape": 7,
          "type": "IMAGE",
          "link": 941
        },
        {
          "name": "masks",
          "shape": 7,
          "type": "MASK",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "links": [
            942,
            944
          ]
        },
        {
          "name": "MASK",
          "type": "MASK",
          "links": null
        }
      ],
      "properties": {
        "cnr_id": "comfyui-kjnodes",
        "ver": "1.1.2",
        "Node name for S&R": "GetImageRangeFromBatch",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        0,
        1
      ]
    },
    {
      "id": 501,
      "type": "WanVaceToVideo",
      "pos": [
        3748.2601907783805,
        2136.4579055660315
      ],
      "size": [
        280,
        260
      ],
      "flags": {},
      "order": 41,
      "mode": 0,
      "inputs": [
        {
          "name": "positive",
          "type": "CONDITIONING",
          "link": 786
        },
        {
          "name": "negative",
          "type": "CONDITIONING",
          "link": 787
        },
        {
          "name": "vae",
          "type": "VAE",
          "link": 788
        },
        {
          "name": "control_video",
          "shape": 7,
          "type": "IMAGE",
          "link": 943
        },
        {
          "name": "control_masks",
          "shape": 7,
          "type": "MASK",
          "link": 877
        },
        {
          "name": "reference_image",
          "shape": 7,
          "type": "IMAGE",
          "link": 944
        },
        {
          "name": "width",
          "type": "INT",
          "widget": {
            "name": "width"
          },
          "link": 945
        },
        {
          "name": "height",
          "type": "INT",
          "widget": {
            "name": "height"
          },
          "link": 946
        },
        {
          "name": "length",
          "type": "INT",
          "widget": {
            "name": "length"
          },
          "link": 989
        }
      ],
      "outputs": [
        {
          "name": "positive",
          "type": "CONDITIONING",
          "links": [
            823,
            830
          ]
        },
        {
          "name": "negative",
          "type": "CONDITIONING",
          "links": [
            824,
            831
          ]
        },
        {
          "name": "latent",
          "type": "LATENT",
          "links": [
            825
          ]
        },
        {
          "name": "trim_latent",
          "type": "INT",
          "links": [
            785
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.34",
        "Node name for S&R": "WanVaceToVideo",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        960,
        544,
        25,
        1,
        1
      ],
      "color": "#332922",
      "bgcolor": "#593930"
    },
    {
      "id": 494,
      "type": "Int",
      "pos": [
        3923.0475085632115,
        1976.2824878149481
      ],
      "size": [
        280,
        60
      ],
      "flags": {},
      "order": 18,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "INT",
          "type": "INT",
          "links": [
            827,
            834,
            836
          ]
        }
      ],
      "title": "Total Steps",
      "properties": {
        "cnr_id": "ComfyLiterals",
        "ver": "bdddb08ca82d90d75d97b1d437a652e0284a32ac",
        "Node name for S&R": "Int",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {
            "Number": true
          },
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        "4"
      ],
      "color": "#232",
      "bgcolor": "#353"
    },
    {
      "id": 496,
      "type": "Power Lora Loader (rgthree)",
      "pos": [
        3062.605951323981,
        1977.154060563319
      ],
      "size": [
        580,
        220
      ],
      "flags": {},
      "order": 38,
      "mode": 0,
      "inputs": [
        {
          "dir": 3,
          "name": "model",
          "type": "MODEL",
          "link": 924
        },
        {
          "dir": 3,
          "name": "clip",
          "type": "CLIP",
          "link": 782
        }
      ],
      "outputs": [
        {
          "dir": 4,
          "name": "MODEL",
          "shape": 3,
          "type": "MODEL",
          "links": [
            829
          ]
        },
        {
          "dir": 4,
          "name": "CLIP",
          "shape": 3,
          "type": "CLIP",
          "links": []
        }
      ],
      "properties": {
        "cnr_id": "rgthree-comfy",
        "ver": "6c5f7c95ed8487fe08e42bd0341cae6dc9c0f0ad",
        "Show Strengths": "Single Strength",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        {},
        {
          "type": "PowerLoraLoaderHeaderWidget"
        },
        {
          "on": true,
          "lora": "lightx2v_T2V_14B_cfg_step_distill_v2_lora_rank64_bf16.safetensors",
          "strength": 1,
          "strengthTwo": null
        },
        {
          "on": false,
          "lora": "wan\\fantasy\\lora-000009.TA_trained.safetensors",
          "strength": 1,
          "strengthTwo": null
        },
        {},
        ""
      ],
      "color": "#323",
      "bgcolor": "#535"
    },
    {
      "id": 522,
      "type": "KSamplerAdvanced",
      "pos": [
        5302.851116581115,
        1954.6809950990569
      ],
      "size": [
        480,
        608.6666870117188
      ],
      "flags": {},
      "order": 46,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "MODEL",
          "link": 829
        },
        {
          "name": "positive",
          "type": "CONDITIONING",
          "link": 830
        },
        {
          "name": "negative",
          "type": "CONDITIONING",
          "link": 831
        },
        {
          "name": "latent_image",
          "type": "LATENT",
          "link": 832
        },
        {
          "name": "noise_seed",
          "type": "INT",
          "widget": {
            "name": "noise_seed"
          },
          "link": 833
        },
        {
          "name": "steps",
          "type": "INT",
          "widget": {
            "name": "steps"
          },
          "link": 834
        },
        {
          "name": "start_at_step",
          "type": "INT",
          "widget": {
            "name": "start_at_step"
          },
          "link": 835
        },
        {
          "name": "end_at_step",
          "type": "INT",
          "widget": {
            "name": "end_at_step"
          },
          "link": 836
        }
      ],
      "outputs": [
        {
          "name": "LATENT",
          "type": "LATENT",
          "links": [
            784
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.33",
        "Node name for S&R": "KSamplerAdvanced",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        "enable",
        234299849652594,
        "fixed",
        15,
        1,
        "uni_pc",
        "beta",
        3,
        15,
        "disable"
      ]
    },
    {
      "id": 495,
      "type": "Int",
      "pos": [
        4946.290842631909,
        2509.445802586108
      ],
      "size": [
        280,
        60
      ],
      "flags": {},
      "order": 19,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "INT",
          "type": "INT",
          "links": [
            828,
            835
          ]
        }
      ],
      "title": "Speed Optimization Start Steps",
      "properties": {
        "cnr_id": "ComfyLiterals",
        "ver": "bdddb08ca82d90d75d97b1d437a652e0284a32ac",
        "Node name for S&R": "Int",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {
            "Number": true
          },
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        "0"
      ],
      "color": "#232",
      "bgcolor": "#353"
    },
    {
      "id": 36,
      "type": "UnetLoaderGGUF",
      "pos": [
        -458.6009902932533,
        1809.5394199914094
      ],
      "size": [
        438.339970682905,
        58
      ],
      "flags": {},
      "order": 20,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "MODEL",
          "type": "MODEL",
          "links": [
            707
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfyui-gguf",
        "ver": "6570efec6992015085f11b84e42d32f6cc71e8b7",
        "Node name for S&R": "UnetLoaderGGUF",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        "SkyReels-V2-T2V-14B-720P-VACE-Q5_K_S.gguf"
      ]
    },
    {
      "id": 549,
      "type": "ImageToMask",
      "pos": [
        2401.5205767033945,
        2873.2357448281577
      ],
      "size": [
        280,
        60
      ],
      "flags": {},
      "order": 28,
      "mode": 0,
      "inputs": [
        {
          "name": "image",
          "type": "IMAGE",
          "link": 881
        }
      ],
      "outputs": [
        {
          "name": "MASK",
          "type": "MASK",
          "links": [
            877
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.43",
        "Node name for S&R": "ImageToMask",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        "red"
      ]
    },
    {
      "id": 572,
      "type": "ImageResizeKJ",
      "pos": [
        2387.373343811532,
        3419.9924794173626
      ],
      "size": [
        315,
        266
      ],
      "flags": {},
      "order": 33,
      "mode": 0,
      "inputs": [
        {
          "name": "image",
          "type": "IMAGE",
          "link": 939
        },
        {
          "name": "get_image_size",
          "shape": 7,
          "type": "IMAGE",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "slot_index": 0,
          "links": [
            940,
            941,
            943,
            949
          ]
        },
        {
          "name": "width",
          "type": "INT",
          "links": [
            945
          ]
        },
        {
          "name": "height",
          "type": "INT",
          "links": [
            946
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfyui-kjnodes",
        "ver": "1.1.9",
        "Node name for S&R": "ImageResizeKJ",
        "ue_properties": {
          "widget_ue_connectable": {},
          "version": "7.4.1",
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        960,
        544,
        "lanczos",
        false,
        2,
        0
      ]
    },
    {
      "id": 503,
      "type": "Note",
      "pos": [
        1324.7596050846416,
        2629.7577884272846
      ],
      "size": [
        270,
        350
      ],
      "flags": {},
      "order": 21,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "properties": {
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        "The masking video should be black where you want to leave the original footage intact and white where you want new frames (or inpainted/outpainted footage) to be generated.  This can extend existing videos but also join multiple clips together while maintaining movement continuity. Also make sure to keep it at about 5-seconds to match Wan's default output length (81 frames at 16 fps or equivalent if the FPS is different). Lastly, the source video you're editing should have actual missing content grayed out (frames to generate or areas you want filled/painted) to match where your mask video is white. You can download VACE's example clip here for the exact length and gray color to use: https://huggingface.co/datasets/ali-vilab/VACE-Benchmark/blob/main/assets/examples/firstframe/src_video.mp4"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 568,
      "type": "ImageConcatMulti",
      "pos": [
        4364.183148044082,
        3582.3137059559917
      ],
      "size": [
        270,
        170
      ],
      "flags": {},
      "order": 49,
      "mode": 0,
      "inputs": [
        {
          "name": "image_1",
          "type": "IMAGE",
          "link": 948
        },
        {
          "name": "image_2",
          "shape": 7,
          "type": "IMAGE",
          "link": 949
        },
        {
          "name": "image_3",
          "type": "IMAGE",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "links": [
            947
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfyui-kjnodes",
        "ver": "1.1.2",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        2,
        "down",
        true,
        null
      ]
    },
    {
      "id": 559,
      "type": "GetImageRangeFromBatch",
      "pos": [
        2434.2402657807056,
        2702.181011688535
      ],
      "size": [
        280.3267578125,
        110
      ],
      "flags": {},
      "order": 22,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "shape": 7,
          "type": "IMAGE",
          "link": null
        },
        {
          "name": "masks",
          "shape": 7,
          "type": "MASK",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "links": []
        },
        {
          "name": "MASK",
          "type": "MASK",
          "links": null
        }
      ],
      "properties": {
        "cnr_id": "comfyui-kjnodes",
        "ver": "1.1.2",
        "Node name for S&R": "GetImageRangeFromBatch",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        0,
        1
      ]
    },
    {
      "id": 499,
      "type": "PrimitiveInt",
      "pos": [
        4316.761729165146,
        1883.2351461406786
      ],
      "size": [
        310,
        82
      ],
      "flags": {},
      "order": 23,
      "mode": 0,
      "inputs": [],
      "outputs": [
        {
          "name": "INT",
          "type": "INT",
          "links": [
            826,
            833
          ]
        }
      ],
      "properties": {
        "cnr_id": "cg-use-everywhere",
        "ver": "6.1.0",
        "Node name for S&R": "Seed Everywhere",
        "ue_properties": {
          "version": "7.5.1",
          "group_restricted": 0,
          "color_restricted": 0,
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {},
          "title_regex": 107324378635127,
          "input_regex": "fixed",
          "fixed_inputs": true,
          "seed_inputs": true
        },
        "ue_convert": true
      },
      "widgets_values": [
        107324378635127,
        "fixed"
      ]
    },
    {
      "id": 565,
      "type": "WanVideoNAG",
      "pos": [
        2483.3426526611165,
        1866.1017938259072
      ],
      "size": [
        270,
        150
      ],
      "flags": {},
      "order": 31,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "MODEL",
          "link": 925
        },
        {
          "name": "conditioning",
          "type": "CONDITIONING",
          "link": 921
        }
      ],
      "outputs": [
        {
          "name": "model",
          "type": "MODEL",
          "links": [
            926
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfyui-kjnodes",
        "ver": "1.1.2",
        "Node name for S&R": "WanVideoNAG",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        11,
        0.25,
        2.5,
        "default"
      ],
      "color": "#232",
      "bgcolor": "#353"
    },
    {
      "id": 521,
      "type": "KSamplerAdvanced",
      "pos": [
        4383.855906539066,
        2118.255391579083
      ],
      "size": [
        480,
        1165.77783203125
      ],
      "flags": {},
      "order": 43,
      "mode": 0,
      "inputs": [
        {
          "name": "model",
          "type": "MODEL",
          "link": 822
        },
        {
          "name": "positive",
          "type": "CONDITIONING",
          "link": 823
        },
        {
          "name": "negative",
          "type": "CONDITIONING",
          "link": 824
        },
        {
          "name": "latent_image",
          "type": "LATENT",
          "link": 825
        },
        {
          "name": "noise_seed",
          "type": "INT",
          "widget": {
            "name": "noise_seed"
          },
          "link": 826
        },
        {
          "name": "steps",
          "type": "INT",
          "widget": {
            "name": "steps"
          },
          "link": 827
        },
        {
          "name": "end_at_step",
          "type": "INT",
          "widget": {
            "name": "end_at_step"
          },
          "link": 828
        }
      ],
      "outputs": [
        {
          "name": "LATENT",
          "type": "LATENT",
          "links": [
            832
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.33",
        "Node name for S&R": "KSamplerAdvanced",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        "enable",
        581528253564326,
        "fixed",
        15,
        6,
        "uni_pc",
        "simple",
        0,
        3,
        "disable"
      ]
    },
    {
      "id": 545,
      "type": "CLIPTextEncode",
      "pos": [
        1814.728186607119,
        1575.5512624919904
      ],
      "size": [
        364.9524767932753,
        149.55663758265064
      ],
      "flags": {
        "collapsed": false
      },
      "order": 27,
      "mode": 0,
      "inputs": [
        {
          "name": "clip",
          "type": "CLIP",
          "link": 862
        }
      ],
      "outputs": [
        {
          "name": "CONDITIONING",
          "type": "CONDITIONING",
          "slot_index": 0,
          "links": [
            786
          ]
        }
      ],
      "title": "CLIP Text Encode (Positive Prompt)",
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.34",
        "Node name for S&R": "CLIPTextEncode",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [
        ""
      ],
      "color": "#232",
      "bgcolor": "#353"
    },
    {
      "id": 502,
      "type": "VAEDecode",
      "pos": [
        5893.6031816287405,
        3090.2276566068954
      ],
      "size": [
        180,
        50
      ],
      "flags": {
        "collapsed": false
      },
      "order": 48,
      "mode": 0,
      "inputs": [
        {
          "name": "samples",
          "type": "LATENT",
          "link": 794
        },
        {
          "name": "vae",
          "type": "VAE",
          "link": 795
        }
      ],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "slot_index": 0,
          "links": [
            948,
            990
          ]
        }
      ],
      "properties": {
        "cnr_id": "comfy-core",
        "ver": "0.3.34",
        "Node name for S&R": "VAEDecode",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": [],
      "color": "#322",
      "bgcolor": "#533"
    },
    {
      "id": 576,
      "type": "VHS_VideoCombine",
      "pos": [
        4796.968605253519,
        3571.6330600365677
      ],
      "size": [
        521.4673226853083,
        844.3296323766828
      ],
      "flags": {},
      "order": 51,
      "mode": 0,
      "inputs": [
        {
          "label": "images",
          "name": "images",
          "type": "IMAGE",
          "link": 947
        },
        {
          "label": "audio",
          "name": "audio",
          "shape": 7,
          "type": "AUDIO",
          "link": null
        },
        {
          "label": "meta_batch",
          "name": "meta_batch",
          "shape": 7,
          "type": "VHS_BatchManager",
          "link": null
        },
        {
          "label": "vae",
          "name": "vae",
          "shape": 7,
          "type": "VAE",
          "link": null
        }
      ],
      "outputs": [
        {
          "label": "Filenames",
          "name": "Filenames",
          "type": "VHS_FILENAMES"
        }
      ],
      "properties": {
        "cnr_id": "comfyui-videohelpersuite",
        "ver": "0a75c7958fe320efcb052f1d9f8451fd20c730a8",
        "Node name for S&R": "VHS_VideoCombine",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {
            "frame_rate": true,
            "loop_count": true,
            "filename_prefix": true,
            "format": true,
            "pingpong": true,
            "save_output": true
          },
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": {
        "frame_rate": 16,
        "loop_count": 0,
        "filename_prefix": "vace_repaint_out",
        "format": "image/webp",
        "lossless": true,
        "pingpong": false,
        "save_output": false,
        "videopreview": {
          "paused": false,
          "hidden": false,
          "params": {
            "filename": "vace_repaint_out_00008.webp",
            "workflow": "vace_repaint_out_00008.png",
            "fullpath": "/code/ComfyUI/temp/vace_repaint_out_00008.webp",
            "format": "image/webp",
            "subfolder": "",
            "type": "temp",
            "frame_rate": 16
          }
        }
      }
    },
    {
      "id": 578,
      "type": "VHS_VideoCombine",
      "pos": [
        5314.8591736456065,
        3860.5668560311847
      ],
      "size": [
        521.4673226853083,
        560.1648161883413
      ],
      "flags": {},
      "order": 50,
      "mode": 0,
      "inputs": [
        {
          "label": "images",
          "name": "images",
          "type": "IMAGE",
          "link": 990
        },
        {
          "label": "audio",
          "name": "audio",
          "shape": 7,
          "type": "AUDIO",
          "link": null
        },
        {
          "label": "meta_batch",
          "name": "meta_batch",
          "shape": 7,
          "type": "VHS_BatchManager",
          "link": null
        },
        {
          "label": "vae",
          "name": "vae",
          "shape": 7,
          "type": "VAE",
          "link": null
        }
      ],
      "outputs": [
        {
          "label": "Filenames",
          "name": "Filenames",
          "type": "VHS_FILENAMES"
        }
      ],
      "properties": {
        "cnr_id": "comfyui-videohelpersuite",
        "ver": "0a75c7958fe320efcb052f1d9f8451fd20c730a8",
        "Node name for S&R": "VHS_VideoCombine",
        "ue_properties": {
          "version": "7.5.1",
          "widget_ue_connectable": {
            "frame_rate": true,
            "loop_count": true,
            "filename_prefix": true,
            "format": true,
            "pingpong": true,
            "save_output": true
          },
          "input_ue_unconnectable": {}
        }
      },
      "widgets_values": {
        "frame_rate": 16,
        "loop_count": 0,
        "filename_prefix": "vace_repaint_out",
        "format": "image/webp",
        "lossless": true,
        "pingpong": false,
        "save_output": false,
        "videopreview": {
          "paused": false,
          "hidden": false,
          "params": {
            "filename": "vace_repaint_out_00009.webp",
            "workflow": "vace_repaint_out_00009.png",
            "fullpath": "/code/ComfyUI/temp/vace_repaint_out_00009.webp",
            "format": "image/webp",
            "subfolder": "",
            "type": "temp",
            "frame_rate": 16
          }
        }
      }
    },
    {
      "id": 570,
      "type": "VHS_LoadVideo",
      "pos": [
        5857.024532631019,
        2951.494852236042
      ],
      "size": [
        707.5852888899663,
        1487.1442777876812
      ],
      "flags": {},
      "order": 24,
      "mode": 0,
      "inputs": [
        {
          "name": "meta_batch",
          "shape": 7,
          "type": "VHS_BatchManager",
          "link": null
        },
        {
          "name": "vae",
          "shape": 7,
          "type": "VAE",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "links": [
            938
          ]
        },
        {
          "name": "frame_count",
          "type": "INT",
          "links": [
            989
          ]
        },
        {
          "name": "audio",
          "type": "AUDIO",
          "links": null
        },
        {
          "name": "video_info",
          "type": "VHS_VIDEOINFO",
          "links": null
        }
      ],
      "properties": {
        "cnr_id": "comfyui-videohelpersuite",
        "ver": "1.7.7",
        "Node name for S&R": "VHS_LoadVideo",
        "ue_properties": {
          "widget_ue_connectable": {},
          "input_ue_unconnectable": {},
          "version": "7.5.1"
        }
      },
      "widgets_values": {
        "video": "72761c3c-022d-425d-9c05-21e62fb796b0.mp4",
        "force_rate": 0,
        "custom_width": 0,
        "custom_height": 0,
        "frame_load_cap": 124,
        "skip_first_frames": 0,
        "select_every_nth": 1,
        "format": "AnimateDiff",
        "choose video to upload": "image",
        "videopreview": {
          "hidden": false,
          "paused": false,
          "params": {
            "filename": "72761c3c-022d-425d-9c05-21e62fb796b0.mp4",
            "type": "input",
            "format": "video/mp4",
            "force_rate": 0,
            "custom_width": 0,
            "custom_height": 0,
            "frame_load_cap": 124,
            "skip_first_frames": 0,
            "select_every_nth": 1
          }
        }
      }
    }
  ],
  "links": [
    [
      56,
      51,
      0,
      54,
      1,
      "CLIP"
    ],
    [
      118,
      41,
      0,
      113,
      0,
      "*"
    ],
    [
      119,
      54,
      1,
      114,
      0,
      "*"
    ],
    [
      622,
      48,
      0,
      49,
      0,
      "MODEL"
    ],
    [
      623,
      397,
      0,
      54,
      0,
      "MODEL"
    ],
    [
      624,
      54,
      0,
      115,
      0,
      "MODEL"
    ],
    [
      704,
      49,
      0,
      429,
      0,
      "MODEL"
    ],
    [
      705,
      429,
      0,
      397,
      0,
      "MODEL"
    ],
    [
      706,
      427,
      0,
      48,
      0,
      "MODEL"
    ],
    [
      707,
      36,
      0,
      48,
      1,
      "MODEL"
    ],
    [
      708,
      47,
      0,
      48,
      2,
      "MODEL"
    ],
    [
      780,
      489,
      0,
      491,
      0,
      "CLIP"
    ],
    [
      782,
      489,
      0,
      496,
      1,
      "CLIP"
    ],
    [
      784,
      522,
      0,
      500,
      0,
      "LATENT"
    ],
    [
      785,
      501,
      3,
      500,
      1,
      "INT"
    ],
    [
      786,
      545,
      0,
      501,
      0,
      "CONDITIONING"
    ],
    [
      787,
      491,
      0,
      501,
      1,
      "CONDITIONING"
    ],
    [
      788,
      490,
      0,
      501,
      2,
      "VAE"
    ],
    [
      794,
      500,
      0,
      502,
      0,
      "LATENT"
    ],
    [
      795,
      490,
      0,
      502,
      1,
      "VAE"
    ],
    [
      822,
      497,
      0,
      521,
      0,
      "MODEL"
    ],
    [
      823,
      501,
      0,
      521,
      1,
      "CONDITIONING"
    ],
    [
      824,
      501,
      1,
      521,
      2,
      "CONDITIONING"
    ],
    [
      825,
      501,
      2,
      521,
      3,
      "LATENT"
    ],
    [
      826,
      499,
      0,
      521,
      4,
      "INT"
    ],
    [
      827,
      494,
      0,
      521,
      5,
      "INT"
    ],
    [
      828,
      495,
      0,
      521,
      6,
      "INT"
    ],
    [
      829,
      496,
      0,
      522,
      0,
      "MODEL"
    ],
    [
      830,
      501,
      0,
      522,
      1,
      "CONDITIONING"
    ],
    [
      831,
      501,
      1,
      522,
      2,
      "CONDITIONING"
    ],
    [
      832,
      521,
      0,
      522,
      3,
      "LATENT"
    ],
    [
      833,
      499,
      0,
      522,
      4,
      "INT"
    ],
    [
      834,
      494,
      0,
      522,
      5,
      "INT"
    ],
    [
      835,
      495,
      0,
      522,
      6,
      "INT"
    ],
    [
      836,
      494,
      0,
      522,
      7,
      "INT"
    ],
    [
      862,
      489,
      0,
      545,
      0,
      "CLIP"
    ],
    [
      877,
      549,
      0,
      501,
      4,
      "MASK"
    ],
    [
      881,
      552,
      0,
      549,
      0,
      "IMAGE"
    ],
    [
      921,
      491,
      0,
      565,
      1,
      "CONDITIONING"
    ],
    [
      924,
      497,
      0,
      496,
      0,
      "MODEL"
    ],
    [
      925,
      488,
      0,
      565,
      0,
      "MODEL"
    ],
    [
      926,
      565,
      0,
      497,
      0,
      "MODEL"
    ],
    [
      938,
      570,
      0,
      571,
      0,
      "IMAGE"
    ],
    [
      939,
      571,
      0,
      572,
      0,
      "IMAGE"
    ],
    [
      940,
      572,
      0,
      573,
      0,
      "IMAGE"
    ],
    [
      941,
      572,
      0,
      574,
      0,
      "IMAGE"
    ],
    [
      942,
      574,
      0,
      575,
      0,
      "IMAGE"
    ],
    [
      943,
      572,
      0,
      501,
      3,
      "IMAGE"
    ],
    [
      944,
      574,
      0,
      501,
      5,
      "IMAGE"
    ],
    [
      945,
      572,
      1,
      501,
      6,
      "INT"
    ],
    [
      946,
      572,
      2,
      501,
      7,
      "INT"
    ],
    [
      947,
      568,
      0,
      576,
      0,
      "IMAGE"
    ],
    [
      948,
      502,
      0,
      568,
      0,
      "IMAGE"
    ],
    [
      949,
      572,
      0,
      568,
      1,
      "IMAGE"
    ],
    [
      989,
      570,
      1,
      501,
      8,
      "INT"
    ],
    [
      990,
      502,
      0,
      578,
      0,
      "IMAGE"
    ]
  ],
  "groups": [
    {
      "id": 1,
      "title": "Load models here",
      "bounding": [
        -390,
        1510,
        1280,
        1300
      ],
      "color": "#3f789e",
      "font_size": 24,
      "flags": {
        "pinned": true
      }
    },
    {
      "id": 8,
      "title": "Low Vram high ram",
      "bounding": [
        -380,
        1900,
        370,
        240
      ],
      "color": "#a1309b",
      "font_size": 24,
      "flags": {
        "pinned": true
      }
    },
    {
      "id": 9,
      "title": "Normal GGUF loader",
      "bounding": [
        -380,
        1740,
        370,
        140
      ],
      "color": "#a1309b",
      "font_size": 24,
      "flags": {
        "pinned": true
      }
    },
    {
      "id": 14,
      "title": "Safetensors or Checkpoints",
      "bounding": [
        -380,
        1550,
        370,
        170
      ],
      "color": "#a1309b",
      "font_size": 24,
      "flags": {
        "pinned": true
      }
    },
    {
      "id": 15,
      "title": "Sage Attention",
      "bounding": [
        310,
        1850,
        300,
        150
      ],
      "color": "#444",
      "font_size": 24,
      "flags": {
        "pinned": true
      }
    },
    {
      "id": 16,
      "title": "FP16 Accumulation",
      "bounding": [
        310,
        2020,
        300,
        140
      ],
      "color": "#444",
      "font_size": 24,
      "flags": {
        "pinned": true
      }
    },
    {
      "id": 17,
      "title": "Torch Comple",
      "bounding": [
        310,
        2180,
        300,
        260
      ],
      "color": "#444",
      "font_size": 24,
      "flags": {
        "pinned": true
      }
    },
    {
      "id": 18,
      "title": "Video Repaint ÈáçÁπ™",
      "bounding": [
        1314.7596050846416,
        1499.7577884272848,
        5080,
        3880
      ],
      "color": "#88A",
      "font_size": 24,
      "flags": {}
    }
  ],
  "config": {},
  "extra": {
    "ue_links": [],
    "ds": {
      "scale": 0.4555086788659796,
      "offset": [
        -3103.8863063027948,
        -2851.3667817564565
      ]
    },
    "links_added_by_ue": [],
    "frontendVersion": "1.28.8",
    "VHS_latentpreview": false,
    "VHS_latentpreviewrate": 0,
    "VHS_MetadataImage": true,
    "VHS_KeepIntermediate": true
  },
  "version": 0.4
}